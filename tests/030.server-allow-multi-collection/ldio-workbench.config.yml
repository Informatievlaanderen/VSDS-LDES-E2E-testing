server:
  port: 8080
orchestrator:
  pipelines:

    - name: device-models-pipeline
      description: "Uses a HTTP listener accepting NGSI-v2 messages, converts them to NGSI-LD, and sends NGSI-LD version objects using HTTP to an LDES server."
      input:
        name: be.vlaanderen.informatievlaanderen.ldes.ldio.LdioHttpIn
        adapter:
          name: "be.vlaanderen.informatievlaanderen.ldes.ldi.NgsiV2ToLdAdapter"
          config:
            dataIdentifier: data
            coreContext: https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context-v1.6.jsonld
      transformers:
        - name: be.vlaanderen.informatievlaanderen.ldes.ldi.VersionObjectCreator
          config:
            member-type: https://uri.etsi.org/ngsi-ld/default-context/DeviceModel
            delimiter: "/"
            date-observed-property: ""
            generatedAt-property: http://www.w3.org/ns/prov#generatedAtTime
            versionOf-property: http://purl.org/dc/terms/isVersionOf
      outputs:
        - name: be.vlaanderen.informatievlaanderen.ldes.ldio.LdioHttpOut
          config:
            endpoint: http://ldes-server:8080/device-models
            content-type: application/n-quads

    - name: devices-pipeline
      description: "Uses a HTTP listener accepting NGSI-v2 messages, converts them to NGSI-LD, and sends NGSI-LD version objects using HTTP to an LDES server."
      input:
        name: be.vlaanderen.informatievlaanderen.ldes.ldio.LdioHttpIn
        adapter:
          name: "be.vlaanderen.informatievlaanderen.ldes.ldi.NgsiV2ToLdAdapter"
          config:
            dataIdentifier: data
            coreContext: https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context-v1.6.jsonld
      transformers:
        - name: be.vlaanderen.informatievlaanderen.ldes.ldi.VersionObjectCreator
          config:
            member-type: https://uri.etsi.org/ngsi-ld/default-context/Device
            delimiter: "/"
            # date-observed-property: "[<https://uri.etsi.org/ngsi-ld/default-context/dateLastValueReported> <https://uri.etsi.org/ngsi-ld/hasValue>]"
            generatedAt-property: http://www.w3.org/ns/prov#generatedAtTime
            versionOf-property: http://purl.org/dc/terms/isVersionOf
      outputs:
        - name: be.vlaanderen.informatievlaanderen.ldes.ldio.LdioHttpOut
          config:
            endpoint: http://ldes-server:8080/devices
            content-type: application/n-quads

    - name: observations-pipeline
      description: "Uses a HTTP listener accepting NGSI-v2 messages, converts them to OSLO, and sends NGSI-LD version objects using HTTP to an LDES server."
      input:
        name: be.vlaanderen.informatievlaanderen.ldes.ldio.LdioHttpIn
        adapter:
          name: "be.vlaanderen.informatievlaanderen.ldes.ldi.NgsiV2ToLdAdapter"
          config:
            dataIdentifier: data
            coreContext: https://uri.etsi.org/ngsi-ld/v1/ngsi-ld-core-context-v1.6.jsonld
      transformers:
        - name: be.vlaanderen.informatievlaanderen.ldes.ldi.SparqlConstructTransformer
          config:
            query: "observations.rq"
        - name: be.vlaanderen.informatievlaanderen.ldes.ldi.VersionObjectCreator
          config:
            member-type: http://www.w3.org/ns/sosa/ObservationCollection
            delimiter: "/"
            date-observed-property: http://www.w3.org/ns/sosa/phenomenonTime
            generatedAt-property: http://www.w3.org/ns/prov#generatedAtTime
            versionOf-property: http://purl.org/dc/terms/isVersionOf
      outputs:
        - name: be.vlaanderen.informatievlaanderen.ldes.ldio.LdioHttpOut
          config:
            endpoint: http://ldes-server:8080/water-quality-observations
            content-type: application/n-quads
